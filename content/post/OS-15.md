---
title: "OS 15 - 파일 시스템"
date: 2023-08-02T19:54:08+09:00
draft: true
---

## 15-1 파일과 디렉터리
파일과 디렉터리는 운영체제 내부 파일 시스템이 관리하는 존재이다.

### 파일
**파일**이란, 하드 디스크나 SSD와 같은 보조기억장치에 저장된 관련 정보의 집합이다. 모든 파일에는 이름, 파일을 실행하기 위한 정보, 파일 관련 부가 정보가 있다.

이 부가 정보를 **속성**(==**메타데이터**)이라고 부른다. 속성은 파일 형식, 위치, 크기 등 파일과 관련된 다양한 정보이다.

파일 속성 중 **파일 유형** 은 운영체제가 인식하는 파일 종류로, **확장자**를 이용한다.

파일을 다루는 모든 작업은 **시스템 호출** 을 통해 제공된다.

### 디렉터리
모든 파일이 하나의 디렉터리 아래에 있는 구조를 **1단계 디렉터리** 라고 부른다. 1단계 디렉터리로는 많은 파일을 관리하기가 어려워 **트리 구조 디렉터리**가 생겼다.

최상위 디렉터리는 **루트 디렉터리** 라고 부르며 슬래시(/)로 표현한다.

- 절대경로 : /home/yumin/blog
- 상대경로 : 현재 디렉터리 경로가 /home 경우, yumin/blog

디렉터리를 다루는 모든 작업은 **시스템 호출** 을 통해 제공된다.

운영체제는 디렉터리를 파일로 간주한다. 파일이 내부 해당 파일과 관련된 정보를 담고 있다면, 디렉터리는 담겨있는 대상과 관련된 정보를 담고 있다.

## 15-2 파일 시스템
**파일 시스템** 은 파일과 디렉터리를 보조기억장치에 저장하고 접근할 수 있게 하는 운영체제 내부 프로그램이다. 파일 시스템은 다양한 종류가 있고, 하나의 컴퓨터에서 여러 파일 시스템을 사용할 수 있다.

### 파티셔닝과 포매팅
**파티셔닝**
- 저장 장치의 논리적인 영역을 구획하는 작업
- 저장 장치의 영역을 나누는 작업
- **파티션** : 나누어진 영역 하나하나

**포매팅**
- 파일 시스템을 설정하여 파일 저장/관리 방식을 결정하고 새로운 데이터를 쓸 준비를 하는 작업

### 파일 할당 방법
운영체제는 파일과 디렉터리를 **블록** 단위로 읽고 쓴다. 파일을 보조기억장치에 할당하는 방법은 연속 할당/불연속 할당 방식이 있고, 불연속 할당 방식에는 연결 할당/색인 할당이 있다.

#### 연속 할당
- 보조기억장치 내 연속적인 블록에 파일을 할당
- 연속으로 할당된 파일에 접근하기 위해서는 파일의 첫 번째 블록 주소와 블록 단위의 길이만 알면 됨
- 디렉터리 엔트리 : 파일 이름, 첫 번째 블록 주소, 길이
- 단점 : 외부 단편화
  - 파일 삭제 후 애매하게 남은 빈 블록을 사용할 수 없게 됨

#### 연결 할당
- 각 블록 일부에 다음 블록의 주소를 저장하여 각 블록이 다음 블록을 가리키는 형태로 할당하는 방식
- 디렉터리 엔트리 : 파일 이름, 첫 번째 블록 주소, 길이
- 반드시 첫 번째 블록부터 하나씩 차례대로 읽어야 함
  - 중간부터 접근하고 싶어도, 처음부터 접근해야함 == 임의 접근 속도가 매우 느림
- 하드웨어 고장/오류 발생 시 해당 블록 이후 블록은 접근할 수 없음

#### 색인 할당
- 파일의 모든 블록 주소를 색인 블록이라는 하나의 블록에 모아 관리하는 방식
- 디렉터리 엔트리 : 파일 이름, 색인 블록

### 파일 시스템
#### FAT 파일 시스템
- 블록 안에 다음 블록 주소를 저장하는 연결 할당 단점을 보완하는 파일 시스템
- **파일 할당 테이블(FAT)** 사용
  - 각 블록에 포함된 다음 블록의 주소들을 한 곳에 모아 테이블 형태로 관리
- 디렉터리 엔트리 : 파일 이름, 첫 번째 블록 주소

FAT 파일 시스템에서 FAT는 파티션의 앞부분에 만들어진다.

[예약 영역] [FAT 영역] [루트 디렉터리 영역] [데이터 영역]

FAT는 실행 도중 메모리에 캐시될 수 있다. 메모리에 적재된 채 실행되면 기존 연결 할당보다 다음 블록을 찾는 속도가 매우 빨라진다. 또한 연결 할당 방식보다 임의 접근에도 유리해진다.

####유닉스 파일 시스템
- 색일 할당 기반의 파일 시스템
- 색인 블록을 i-node(index-node) 라고 부른다.

i-node에는 파일 속성 정보와 열다섯 개의 블록 주소가 저장될 수 있다.

FAT 파일 시스템에서는 파일 속성 정보가 디렉터리 엔트리에 표현되었지만, 유닉스 파일 시스템에서 파일 속성 정보는 i-node에 표현된다.

[예약 영역] [i-node 영역] [데이터 영역]

i-node 영역은 제한적이기 때문에 다음과 같은 방법으로 파일의 데이터 블록을 모두 가리킨다.

(1) 블록 주소 중 열두 개에는 직접 블록 주소를 저장한다.

i-node가 가리킬 수 있는 열다섯 개의 블록 주소 중 처음 열두 개에는 파일 데이터가 저장된 블록 주소가 직접적으로 명시된다.

(2) 열세 번째 주소에 단일 간접 블록 주소를 저장한다.
열두 개의 블록 주소로 파일의 모든 블록을 가리킬 수 없다면 열세 번째 블록 주소를 이용해야한다. 열세 번째 블록 주소는 단일 간접 블록의 주소로 저장한다.

단일 간접 블록이란 파일 데이터를 저장한 블록 주소가 저장된 블록이다.

(3) 열네 번째 주소에 이중 간접 블록 주소를 저장한다.

(4) 열다섯 번째 주소에 삼중 간접 블록 주소를 저장한다.

유닉스 파일 시스템의 디렉터리 엔트리도 i-node 번호와 파일 이름으로 구성된다.