---
title: "[DB] 기본키와 외래키"
date: 2024-01-16T19:37:26+09:00
draft: true
categories :
- DataBase
---

# 기본키와 외래키
## 키 (key)
키는 유일하게 식별한다는 의미가 있다. 데이터베이스에서는 키는 특정 튜플을 식별할 때 중요하게 사용된다. 키에는 다양한 종류가 있는데,
키에 대해 알아보기 전 `유일성`, `최소성` 이라는 개념을 알아야 한다.

> **유일성**
> 
> 하나의 키 값으로 튜플을 식별할 수 있는가?

> **최소성**
> 
> 
> 키를 구성하는 속성들이, 각 튜플을 구분하는데 꼭 필요한 속성들로 구분되어 있는가?

## 키 종류
<img width="439" alt="image" src="https://github.com/yumin00/blog/assets/130362583/aafb73a0-c6d8-4fa0-86de-332d8a87d1b4">

### (1) 슈퍼키 (Super Key)
- 각 행을 유일하게 식별할 수 있는 속성들의 집합
- 유일성 O / 최소성 X
- 예시
  - id : id로 식별할 수 있으므로 슈퍼키 O
  - id - name : id, name으로 식별할 수 있으므로 슈퍼키 O
  - name - age - sex : name, age, sex가 같은 사람이 있을 수 있으므로 슈퍼키 X

### (2) 후보키 (Candidate Key)
- 슈퍼키 중에서도 최소성을 만족하는 키를 후보키라고 한다.
- 유일성 O / 최소성 O
- 예시
  - 슈퍼키 중, 최소성을 만족하는 키는 id 밖에 없으므로 id는 후보키이다.

### (3) 기본키 (Primary Key)
- 후보키들 중 메인으로 선정되는 키로, 후보키 성질을 갖는다.
- 유일성 O / 최소성 O

### (4) 외래키 (Foreign Key)
- 테이블간의 관계를 나타낼 때, 다른 테이블의 기본키를 참조해 외래키로 사용
- 예시
  - score의 student_id 는 student 의 id 의 외래키이다.

### (5) 복합키 (Composite key)
- 두개 이상의 컬럼을 묶어서 하나의 기본키로 지정
- 기본키는 하나의 테이블에 하나만 존재할 수 있다. 또한, 기본키는 하나 이상의 컬럼으로 구성되어 있다.

### (6) 대체키 (Alternative Key)
- 기본키를 제외한 나머지 후보키들을 의미

## 기본키와 외래키
### 기본키 특징
- 기본키로 각 레코드를 식별할 수 있어야 한다.
- NULL 값이 존재할 수 없다.
- 후보키 중 단순한 키를 기본키로 선택한다.
- 테이블에는 하나의 기본키만 가질 수 있지만, 경우에 따라 1개 이상의 기본키를 정의할 수도 있다.

### 외래키 특징
- 외래키를 가지고 있는 테이블이 하위 테이블, 기본키를 가지고 있는 테이블이 상위 테이블
- 각 외래키와 기본키는 1:1 매칭이 되어야 한다.
- 데이터 무결성을 유지하는 데 중요한 역할을 한다.

## 외래키 장단점
### 외래키 장점
- 데이터 무결성 유지
- 스키마를 통해 테이블간 관계를 명확하게 파악 가능

### 외래키 단점
#### 오버헤드 발생
CRUD 발생시, 데이터 정합성을 위해서 DBMS에서는 추가적인 쿼리를 실행시켜 외래키로 지정된 다른 테이블에 row가 존재하는지 확인하고, 해당 row가 삭제될 경우,
연관된 다른 row들도 삭제하는 등의 오버헤드가 발생하여 성능 부하 문제가 발생할 수 있다는 우려가 있다. 하지만 이는 오버헤드 비용이 그렇게 크지 않다고 한다.

#### 개발 시 불편함 발생
외래키의 참조 무결성 제약조건으로 인해 부모 - 자식 관계에서 자식 테이블에 row를 추가할 경우, 자식이 외래키로 참조하고 있는 부모 테이블에 row가 있어야 DML 작업이 가능하다.

#### 관리 포인트 증가
트랜잭션 안에서 부모-자식 테이블 관계에 따라 작업 순서가 필요하다.

#### 더 큰 수정 개발
데이터베이스를 초기에 설계를 잘 해놓았다고 하더라도, 시간이 지나면서 추가 개발/설계가 진행될 수 있다.
데이터 정합성릉 위해 사용한 외래키가 이후에 더 큰 수정 개발을 불러 일으킬 수도 있다.