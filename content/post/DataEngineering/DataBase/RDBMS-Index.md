---
title: "RDBMS에서 Index를 사용하는 이유"
date: 2024-04-18T19:52:46+09:00
draft: false
categories :
- DataBase
- DataEngineering
---

RDMBS에서는 Index를 사용한다. 그렇다면 RDBMS에서는 왜 index를 사용할까?

# Index란?
인덱스란, 색인/지표를 의미하는 단어로 테이블의 검색 속도를 향상시키기 위해 사용하는 자료구조이다. RDBMS에서도 테이블 검색 속도를 향상시키기 위해 인덱스를 사용한다고 한다.

# 인덱스를 사용하면 왜 속도가 빨라질까?
예를 들어 백과사전에서 원하는 단어를 찾아야할 때 모든 단어를 다 훑어보면서 단어를 찾으려고 한다면 시간이 아주 오래 걸릴 것이다. 그래서 백과사전에는 색인이 존재하여 단어를 좀 더 쉽고 빠르게 찾을 수 있게 해준다.

이와 같이 테이블에서도 원하는 데이터를 찾을 때, 모든 데이터를 검색하여 찾는다면 시간이 아주 오래 걸릴 것이다. 때문에, 백과사전의 색인처럼 Index를 사용하는 것이다.

![image](https://github.com/yumin00/blog/assets/130362583/66a4ae98-cea4-4eaa-b8db-59357c701992)

예를 들어서, 위 사진처럼 user_id를 Index로 갖는다고 가정해보자. 그러면 index는 user_id의 값과 해당 데이터의 포인터를 가지고 있다. 특정 user_id를 통해 score를 검색한다면,
index를 통해 먼저 user_id의 pointer를 얻고 해당 pointer를 통해 score를 찾을 수 있는 것이다.

이러한 방법을 통해서, 모든 데이터를 검색하지 않고도 index를 통해 데이터를 빠르게 찾을 수 있다.

인덱스를 구현하는 방법은 여러가지가 있는데, 대표적인 방법에 대해 알아보자.

# Hash Table
![image](https://github.com/yumin00/blog/assets/130362583/0902e423-a4ea-4451-9800-ff2816c01997)
해시 테이블은 (key, value) 로 데이터를 저장하는 자료구조이다. 

위 그림처럼, key를 넣으면 hash function을 통해 value를 얻음으로써 index의 값을 넣으면 해당 데이터의 주소를 가지고 데이터를 검색하는 자료구조인 것이다.

해시 테이블의 시간 복잡도는 O(1)로 매우 빠른 검색을 지원한다.

하지만 hash table은 사실 Index에는 많이 사용되지 않는다. 그 이유는 hash function은 정확히 일치하는 값만 찾을 수 있기 때문에,
LIKE나 부등호를 사용하는 쿼리 검색에는 용이하지 않기 때문이다.

# B+Tree
![image](https://github.com/yumin00/blog/assets/130362583/3276b27c-6d7b-42d6-beb5-8d90ab8ab082)

B+Tree는 트리 기반 구조로, DB 성능을 최적화하기 위해 설계된 것이다.

- 내부 노드: key / 리프 노드의 pointer
- 리프 노드: data의 pointer

해당 키를 찾을 때까지 내부 노드를 돌고, 키를 찾으면 리프 노드의 포인터를 통해 데이터 검색하는 방식으로 동작한다.

실제 데이터 포인터가 리프 노드에만 저장되어 있기 때문에, 리프 노드에 도달할 때까지 실제 데이터에 접근할 필요가 업식 때문에 불필요한 디스크 I/O를 줄일 수 있다.

또한, 리프 노드가 모두 같은 깊이에 위치하기 때문에, 어떤 데이터에 접근하든 접근 시간이 일정하다.

# Full Table Scan
Full Table Scan은 DB에서 데이터를 검색하는 방법 중 하나이다.

이는, 인덱스를 사용하지 않고 테이블의 모든 행을 처음부터 끝까지 순차적으로 읽고 데이터를 검색하는 방식이다.

테이블의 데이터 양이 적거나, 거의 모든 데이터를 반환해야하는 경우에는 Full Table Scan을 사용하는 것이 효율적일 수 있다.

또한, B+Tree는 leaf node까지 내려가서 데이터를 찾아야하기 때문에, 데이터 양이 적다면 Full  Table Scan을 사용하는 것이 더 빠를 수 있다.

# 인덱스의 단점
- 인덱스를 관리하기 위해서는 DB의 약 10% 정도의 공간이 필요하다는 단점이 있다.
- 데이터 삽입, 삭제, 수정이 이루어질 경우, index도 함께 업데이트 되어야 한다. 이로 인해 데이터 변경 작업이 느려질 수 있다.
  - 자주 변경되는 데이터에 대해 인덱스가 설정되어 있다면, 데이터 변경과 인덱스 업데이트가 같이 이루어져 느려질 수 있다.